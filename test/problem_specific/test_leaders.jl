using UTCGP.listinteger_iscond: is_more_eq_than_right
using UTCGP.listgeneric_subset: subset_by_mask
using UTCGP: listinteger_caster
train_data = [
    [[Int[]], [[]]],
    [[[0]], [[0]]],
    [[[451]], [[451]]],
    [[[1000, 0]], [[1000, 0]]],
    [[[0, 1000]], [[1000]]],
    [[[20, 137, 20]], [[137, 20]]],
    [[[47, 87, 43, 44]], [[87, 44]]],
    [[[5, 5, 5, 5, 5, 5, 5]], [[5, 5, 5, 5, 5, 5, 5]]],
    [[[10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0]], [[10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0]]],
    [[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]], [[10]]],
    [
        [[
            4,
            79,
            945,
            922,
            440,
            64,
            453,
            182,
            768,
            198,
            854,
            579,
            721,
            169,
            346,
            814,
            902,
            958,
            649,
        ]],
        [[958, 649]],
    ],
    [[[87, 573, 674]], [[674]]],
    [[[294, 664, 526, 553, 790, 405]], [[790, 405]]],
    [
        [[684, 55, 126, 158, 127, 600, 369, 261, 57, 534, 189, 316, 463, 563, 622]],
        [[684, 622]],
    ],
    [[[393, 340, 447, 99]], [[447, 99]]],
    [
        [[750, 388, 134, 981, 480, 491, 631, 227, 522, 467, 625, 499, 331, 162, 346, 983]],
        [[983]],
    ],
    [[[437, 392, 583, 997, 961, 689]], [[997, 961, 689]]],
    [
        [[
            503,
            117,
            291,
            274,
            200,
            702,
            872,
            789,
            801,
            201,
            886,
            985,
            73,
            576,
            193,
            534,
            251,
            22,
            941,
            245,
        ]],
        [[985, 941, 245]],
    ],
    [[[999, 144, 572]], [[999, 572]]],
    [
        [[819, 353, 313, 10, 564, 721, 827, 768, 688, 198, 852, 610, 97, 902, 779, 366]],
        [[902, 779, 366]],
    ],
    [[[23, 243, 810, 452, 625, 804, 645, 992, 642]], [[992, 642]]],
    [
        [[
            467,
            674,
            473,
            702,
            519,
            492,
            375,
            56,
            764,
            680,
            316,
            976,
            728,
            648,
            123,
            946,
            403,
            120,
            340,
            187,
        ]],
        [[976, 946, 403, 340, 187]],
    ],
    [
        [[
            443,
            39,
            764,
            925,
            523,
            240,
            674,
            691,
            884,
            644,
            139,
            475,
            534,
            54,
            429,
            465,
            348,
        ]],
        [[925, 884, 644, 534, 465, 348]],
    ],
    [[[407, 481, 224, 807, 342]], [[807, 342]]],
    [[[482, 968, 664, 583, 567, 19, 425, 455]], [[968, 664, 583, 567, 455]]],
    [
        [[
            771,
            202,
            349,
            722,
            122,
            391,
            297,
            289,
            755,
            797,
            622,
            10,
            900,
            468,
            564,
            147,
            13,
            54,
            153,
            361,
        ]],
        [[900, 564, 361]],
    ],
    [
        [[619, 532, 750, 450, 903, 956, 158, 278, 365, 846, 565, 471, 951, 70, 76]],
        [[956, 951, 76]],
    ],
    [
        [[818, 428, 281, 725, 90, 537, 188, 815, 776, 840, 624, 434, 427]],
        [[840, 624, 434, 427]],
    ],
    [[[270, 941, 619, 434, 477, 840, 358, 997]], [[997]]],
    [
        [[148, 447, 497, 245, 350, 46, 646, 221, 561, 883, 74, 85, 700, 188, 339]],
        [[883, 700, 339]],
    ],
    [[[155, 888, 846, 117, 580, 732, 888, 593, 296, 48]], [[888, 888, 593, 296, 48]]],
    [
        [[
            754,
            415,
            232,
            820,
            322,
            927,
            18,
            152,
            916,
            616,
            459,
            725,
            867,
            955,
            625,
            975,
            744,
        ]],
        [[975, 744]],
    ],
    [[[332, 478, 620, 79, 15]], [[620, 79, 15]]],
    [
        [[
            652,
            796,
            497,
            369,
            211,
            902,
            680,
            157,
            338,
            542,
            152,
            215,
            900,
            521,
            759,
            681,
            176,
            679,
            241,
            381,
        ]],
        [[902, 900, 759, 681, 679, 381]],
    ],
    [[[284, 773, 13, 558, 265, 573, 184, 152, 664, 216, 236, 389, 803, 52]], [[803, 52]]],
    [[[890, 285]], [[890, 285]]],
    [[[672, 389, 968, 206, 703, 358, 798, 289]], [[968, 798, 289]]],
    [[[753, 166, 796, 350, 940]], [[940]]],
    [[[686, 25, 335, 145, 818, 657, 57]], [[818, 657, 57]]],
    [
        [[472, 356, 425, 668, 717, 716, 347, 958, 982, 678, 290, 89, 567, 963, 696]],
        [[982, 963, 696]],
    ],
    [
        [[429, 975, 733, 712, 628, 923, 277, 183, 405, 500, 808, 216]],
        [[975, 923, 808, 216]],
    ],
    [[[644, 0, 405, 835, 643]], [[835, 643]]],
    [
        [[
            26,
            337,
            607,
            56,
            452,
            567,
            931,
            194,
            134,
            436,
            64,
            721,
            471,
            501,
            205,
            572,
            156,
        ]],
        [[931, 721, 572, 156]],
    ],
    [[[743, 59, 251, 74, 420, 220, 319, 576, 285, 474, 855]], [[855]]],
    [
        [[
            73,
            884,
            634,
            369,
            683,
            318,
            964,
            737,
            663,
            108,
            549,
            40,
            856,
            982,
            186,
            376,
            540,
        ]],
        [[982, 540]],
    ],
    [[[916, 951, 468, 116, 674, 885, 206, 985, 134]], [[985, 134]]],
    [[[36, 812, 509, 385]], [[812, 509, 385]]],
    [
        [[
            46,
            428,
            114,
            938,
            882,
            30,
            124,
            429,
            62,
            350,
            518,
            244,
            402,
            931,
            220,
            611,
            283,
        ]],
        [[938, 931, 611, 283]],
    ],
    [[[654, 171, 683, 57, 498, 447, 908, 176]], [[908, 176]]],
    [[[803, 450, 627, 5, 277, 17, 534, 872]], [[872]]],
]

function algo_leaders(x, y)
    # more than right
    x = listinteger_caster(x[1])
    y = y[1]
    #
    is_m = is_more_eq_than_right(x)
    # subset
    pred = subset_by_mask(x, is_m)
    return pred == y
end

@testset "leaders" begin
    for (x, y) in train_data
        @test begin
            algo_leaders(x, y)
        end
    end
end
